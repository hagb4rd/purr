module Data.Boolean {
  import Phemme.Core

  # -- Implicitly: data Boolean = false | true
  export Boolean?

  implement Equality for Boolean {
    method $this === $that => ffi "$this === $that"
  }

  implement Ordered for Boolean {
    method $this compare-to: $that => case $this, $that of
      | true, false => Less
      | false, true => Greater
      | _           => Equal
  }

  implement Representable for Boolean {
    method $this describe => ffi "$this.toString()"
  }

  implement Parseable for Boolean {
    method $this parse: $text -> Boolean? =>
      | $text === "true"  => true Success
      | $text === "false" => false Success
      | otherwise         => "Not a Boolean." Failure
  }

  implement Bounded for Boolean {
    method $this upper-bound => true
    method $this lower-bound => false
  }

  implement Enumerable for Boolean {
    method $this successor => case $this of
                              | false => true
    method $this predecessor => case $this of
                                | true => false
  }

  implement BooleanAlgebra for Boolean {
    method $this && $that ^Boolean? => ffi "$this && $that"
    method $this || $that ^Boolean? => ffi "$this || $that"
    method not($this) => ffi "!$this"
  }

  export $test ^Boolean? then: $consequent ^Function? else: $alternate ^Function? =>
    | ($test)   => $consequent()
    | otherwise => $alternate()

}
